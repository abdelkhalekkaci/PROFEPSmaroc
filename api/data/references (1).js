// ============================================================================
// RÉFÉRENCES PARTAGÉES - /api/data/references.js
// ============================================================================

const OTI = {
    '1AC': "À la fin de la 1ère année du cycle secondaire collégial, l'élève doit être capable d'acquérir une motricité correcte lui permettant de s'adapter aux exigences des différentes situations motrices et de s'intégrer positivement dans le groupe classe tout en respectant les règles de sécurité et de fair-play.",
    '2AC': "À la fin de la 2ème année du cycle secondaire collégial, l'élève doit être capable d'ajuster et de maîtriser son énergie physique pour effectuer des réalisations motrices coordonnées et organisées, tout en développant ses capacités d'adaptation aux situations variées et en respectant les règles de jeu.",
    '3AC': "À la fin de la 3ème année du cycle secondaire collégial, l'élève doit être capable d'ajuster les éléments de l'acte moteur et de s'adapter aux différentes situations en fonction de leurs exigences organisationnelles et réglementaires, tout en faisant preuve d'autonomie et de responsabilité.",
    'TC': "À la fin du Tronc Commun, l'élève doit être capable de maîtriser les composantes du comportement moteur et de s'adapter aux différentes situations motrices tout en développant son sens critique et sa capacité à gérer efficacement ses ressources physiques et mentales.",
    '1AB': "À la fin de la 1ère année du Baccalauréat, l'élève doit être capable de confronter et d'analyser différentes situations motrices complexes et d'améliorer ses réalisations par une gestion efficace de ses ressources, tout en s'inscrivant dans une démarche de projet individuel ou collectif.",
    '2AB': "À la fin de la 2ème année du Baccalauréat, l'élève doit être capable d'analyser finement les différentes situations motrices et de s'intégrer efficacement dans la réalisation de projets collectifs et individuels, en faisant preuve d'expertise technique et d'intelligence tactique."
};

const OTC = {
    'Handball': { '1AC': "Conserver collectivement la balle et participer activement au jeu pour progresser vers la cible adverse et marquer en situation de jeu réduit, tout en respectant les règles fondamentales.", '2AC': "Faire progresser la balle vers la cible par des déplacements variés et des passes adaptées, en s'inscrivant dans une organisation collective simple.", '3AC': "S'inscrire dans un projet collectif basé sur l'alternance rapide attaquant/défenseur, en utilisant des combinaisons simples et en exploitant les espaces libres.", 'TC': "Utiliser des moyens techniques et tactiques adaptés pour créer des situations favorables au tir, en s'organisant collectivement.", '1AB': "Mettre en œuvre des choix tactiques collectifs pertinents avec vitesse d'exécution adaptée, en coordonnant les actions individuelles.", '2AB': "Élaborer une stratégie collective basée sur la maîtrise des rôles et l'occupation rationnelle de l'espace." },
    'Football': { '1AC': "Conserver le ballon individuellement et collectivement pour progresser vers le but adverse, en utilisant des conduites de balle et des passes simples.", '2AC': "Faire progresser le ballon par des conduites maîtrisées et des passes précises vers des partenaires démarqués.", '3AC': "Participer à un projet de jeu collectif intégrant les transitions attaque-défense, en occupant rationnellement l'espace.", 'TC': "Organiser le jeu collectif en utilisant les fondamentaux techniques au service de la progression vers le but.", '1AB': "S'adapter aux configurations de jeu pour optimiser les choix tactiques individuels et collectifs.", '2AB': "Concevoir et appliquer des stratégies de jeu adaptées au rapport de force." },
    'Basketball': { '1AC': "Conserver la balle et progresser vers la cible en utilisant le dribble et la passe, tout en respectant les règles.", '2AC': "Créer et exploiter des situations favorables au tir par le démarquage et la circulation de balle.", '3AC': "S'inscrire dans une organisation collective offensive et défensive équilibrée.", 'TC': "Optimiser la circulation de balle pour créer le déséquilibre défensif.", '1AB': "Analyser le rapport de force et adapter ses choix tactiques en fonction des réactions adverses.", '2AB': "Mettre en œuvre des systèmes de jeu élaborés en attaque et en défense." },
    'Volleyball': { '1AC': "Se déplacer et se placer correctement pour renvoyer la balle dans le camp adverse, en utilisant la manchette et la touche haute.", '2AC': "Construire l'attaque par un renvoi indirect utilisant un relais, en s'organisant pour la réception-passe-attaque.", '3AC': "Organiser la défense et orienter la construction offensive vers la zone avant.", 'TC': "S'organiser collectivement dans la limite des trois touches réglementaires.", '1AB': "Optimiser la construction du point avec des rôles différenciés.", '2AB': "Mettre en place une organisation collective avec combinaisons offensives variées." },
    'Course de vitesse': { '1AC': "Réagir rapidement au signal de départ et maintenir sa vitesse maximale sur une distance courte (40-60m).", '2AC': "Améliorer sa technique de course (fréquence et amplitude) pour optimiser sa vitesse sur 60-80m.", '3AC': "Gérer sa course du départ à l'arrivée en optimisant l'accélération et le maintien de vitesse.", 'TC': "Maîtriser les différentes phases de la course de vitesse pour réaliser sa meilleure performance.", '1AB': "Analyser et améliorer ses points faibles techniques et physiques.", '2AB': "Atteindre son potentiel maximal par une préparation et une exécution optimales." },
    'Saut en longueur': { '1AC': "Réaliser une course d'élan progressivement accélérée suivie d'une impulsion et une réception équilibrée.", '2AC': "Enchaîner une course d'élan régulière, une impulsion active et un saut avec attitude aérienne simple.", '3AC': "Optimiser sa course d'élan étalonnée pour faire coïncider vitesse maximale et planche d'appel.", 'TC': "Maîtriser l'organisation de sa course d'élan et la qualité de son impulsion.", '1AB': "Augmenter l'efficacité du saut par la maîtrise de la liaison course-impulsion.", '2AB': "Optimiser sa performance en coordonnant les trois phases du saut." },
    'Saut en hauteur': { '1AC': "Franchir une barre en utilisant une course d'élan et une impulsion vers le haut.", '2AC': "Réaliser un franchissement dorsal (fosbury-flop) avec course d'élan courbe adaptée.", '3AC': "Optimiser son franchissement par une meilleure coordination course courbe-impulsion-rotation.", 'TC': "Maîtriser la technique du fosbury-flop avec course d'élan courbe efficace.", '1AB': "Améliorer sa performance par l'optimisation de chaque phase technique.", '2AB': "Réaliser une performance optimale en gérant les paramètres de la compétition." },
    'Course de durée': { '1AC': "Courir de façon régulière sur une durée donnée (8-10 min) en gérant son effort.", '2AC': "Adapter son allure de course pour maintenir un effort prolongé (10-12 min).", '3AC': "Construire et respecter un projet de course en fonction de ses capacités (12-15 min).", 'TC': "Planifier et réaliser une performance en gérant efficacement ses ressources énergétiques.", '1AB': "Optimiser sa performance par une gestion stratégique de l'allure.", '2AB': "Atteindre ses objectifs personnels par une stratégie de course adaptée." },
    'Lancer de poids': { '1AC': "Lancer un engin en utilisant une poussée du bras depuis l'épaule, dans le respect des règles.", '2AC': "Coordonner la poussée des jambes et l'action du bras lanceur pour améliorer la distance.", '3AC': "Enchaîner les actions motrices du lancer en respectant la technique.", 'TC': "Réaliser un lancer en maîtrisant la coordination des segments corporels.", '1AB': "Améliorer sa performance par le perfectionnement technique.", '2AB': "Optimiser sa performance par une maîtrise complète de la chaîne de lancer." },
    'Gymnastique': { '1AC': "Réaliser un enchaînement simple au sol comprenant des éléments gymniques de base.", '2AC': "Présenter un enchaînement gymnique varié avec des liaisons fluides.", '3AC': "Concevoir et réaliser un enchaînement individuel au sol avec originalité.", 'TC': "Présenter un enchaînement gymnique au sol avec maîtrise technique.", '1AB': "Composer et réaliser un enchaînement avec continuité et expression personnelle.", '2AB': "Concevoir, réaliser et évaluer un enchaînement gymnique avec expertise." },
    'Tennis de table': { '1AC': "Maintenir un échange en renvoyant la balle sur la table adverse, en utilisant coup droit et revers.", '2AC': "Diriger la balle dans différentes zones de la table pour mettre l'adversaire en difficulté.", '3AC': "Varier les trajectoires, les vitesses et les effets pour prendre l'initiative du point.", 'TC': "Construire le point en utilisant des variations de placement, vitesse et effet.", '1AB': "Élaborer des stratégies de jeu adaptées aux caractéristiques de l'adversaire.", '2AB': "Mettre en œuvre un projet de jeu personnel et l'adapter en cours de match." },
    'Badminton': { '1AC': "Renvoyer le volant dans le terrain adverse en utilisant les frappes de base.", '2AC': "Varier la longueur et la direction de ses frappes pour déplacer l'adversaire.", '3AC': "Alterner jeu long et jeu court pour créer des espaces libres.", 'TC': "Construire le point en exploitant les espaces libres du terrain adverse.", '1AB': "Élaborer des séquences de jeu tactiquement cohérentes.", '2AB': "Concevoir et appliquer une stratégie de jeu personnelle adaptée à l'adversaire." }
};

const VOCABULAIRE_APS = {
    'Handball': 'passe à terre, passe en cloche, réception à deux mains, dribble, tir en appui, tir en suspension, feinte, démarquage, appel de balle, pivot, ailier, arrière, zone 6m, contre-attaque, repli défensif',
    'Football': 'conduite de balle, contrôle orienté, passe courte intérieur du pied, passe longue, tir, dribble, tacle, marquage, démarquage, appel en profondeur, une-deux',
    'Basketball': 'dribble de progression, dribble de protection, passe à terre, passe une main, lay-up, tir en suspension, rebond, écran, pick and roll, démarquage, pivot',
    'Volleyball': 'manchette bras tendus, touche haute, service cuillère, service tennis, smash, bloc, réception, passe, passeur, attaquant, rotation',
    'Course de vitesse': 'position de départ, réaction au signal, mise en action, accélération, fréquence, amplitude, maintien de vitesse, finish',
    'Course de durée': 'allure régulière, gestion de l\'effort, fréquence cardiaque, endurance, récupération, foulée économique',
    'Saut en longueur': 'course d\'élan, marques, planche d\'appel, impulsion, phase d\'envol, réception, fosse',
    'Saut en hauteur': 'course d\'élan courbe, pied d\'appel extérieur, impulsion, rotation dorsale, fosbury-flop, réception',
    'Lancer de poids': 'position dos à l\'aire, tenue au cou, translation, poussée, extension du bras, équilibre final',
    'Gymnastique': 'roulade avant, roulade arrière, ATR, roue, pont, souplesse, équilibre, saut, liaison, amplitude, tenue',
    'Tennis de table': 'coup droit, revers, service court, service long, effet coupé, effet lifté, placement, déplacement',
    'Badminton': 'dégagé, amorti, smash, drive, service court, service long, replacement'
};

const getSituationReference = (aps, isCollege) => {
    const situations = { 'Handball': 'Match 7 contre 7 sur terrain réglementaire (40m x 20m) avec application des règles officielles et arbitrage par les élèves', 'Football': 'Match 7 contre 7 sur terrain réduit (50m x 30m) avec 2 buts et application des règles simplifiées', 'Basketball': 'Match 5 contre 5 sur demi-terrain avec panier et application des règles officielles', 'Volleyball': 'Match 6 contre 6 sur terrain réglementaire (9m x 18m) avec filet à hauteur adaptée et rotation', 'Tennis de table': 'Match en simple au meilleur des 3 sets de 11 points avec application des règles officielles', 'Badminton': 'Match en simple au meilleur des 3 sets de 21 points avec application des règles officielles', 'Course de vitesse': isCollege ? 'Course chronométrée sur 60 mètres en couloir individuel avec départ au signal' : 'Course chronométrée sur 80 mètres en couloir individuel avec départ au signal', 'Saut en longueur': 'Concours de 3 essais mesurés avec course d\'élan libre, la meilleure performance est retenue', 'Saut en hauteur': 'Concours à barres montantes avec 3 essais maximum par hauteur, technique fosbury-flop', 'Lancer de poids': 'Concours de 3 essais mesurés depuis le plateau de lancer, la meilleure performance est retenue', 'Course de durée': 'Course de 12 minutes en régulant son allure pour parcourir la plus grande distance', 'Gymnastique': 'Présentation d\'un enchaînement au sol de 1 minute minimum comprenant les éléments imposés' };
    return situations[aps] || 'Situation adaptée au niveau des élèves';
};

const getGroupeAPS = (aps) => { if (['Handball', 'Football', 'Basketball', 'Volleyball'].includes(aps)) return 'Sports collectifs'; if (['Tennis de table', 'Badminton'].includes(aps)) return 'Sports de renvoi'; if (['Course de vitesse', 'Saut en longueur', 'Saut en hauteur', 'Lancer de poids', 'Course de durée'].includes(aps)) return 'Athlétisme'; if (aps === 'Gymnastique') return 'Gymnastique'; return 'Activité physique'; };

const CRITERES_OBS = {
    'Handball': { criteres: [{ nom: 'Passe', sous: ['Précise', 'Imprécise'] }, { nom: 'Réception', sous: ['Assurée', 'Manquée'] }, { nom: 'Tir', sous: ['Cadré', 'Hors'] }, { nom: 'Démarquage', sous: ['Efficace', 'Passif'] }] },
    'Football': { criteres: [{ nom: 'Conduite', sous: ['Maîtrisée', 'Perdue'] }, { nom: 'Passe', sous: ['Précise', 'Imprécise'] }, { nom: 'Contrôle', sous: ['Orienté', 'Subi'] }, { nom: 'Placement', sous: ['Pertinent', 'Inadapté'] }] },
    'Basketball': { criteres: [{ nom: 'Dribble', sous: ['Tête haute', 'Yeux balle'] }, { nom: 'Passe', sous: ['Précise', 'Interceptée'] }, { nom: 'Tir', sous: ['Équilibré', 'Déséquil.'] }, { nom: 'Démarquage', sous: ['Actif', 'Statique'] }] },
    'Volleyball': { criteres: [{ nom: 'Manchette', sous: ['Bras tendus', 'Pliés'] }, { nom: 'Touche', sous: ['Haute', 'Basse'] }, { nom: 'Service', sous: ['Réussi', 'Faute'] }, { nom: 'Placement', sous: ['Anticipé', 'Retard'] }] },
    'Course de vitesse': { criteres: [{ nom: 'Départ', sous: ['Réactif', 'Lent'] }, { nom: 'Accélération', sous: ['Progress.', 'Brutale'] }, { nom: 'Maintien', sous: ['Stable', 'Décélère'] }, { nom: 'Finish', sous: ['Engagé', 'Relâché'] }] },
    'Saut en longueur': { criteres: [{ nom: 'Course', sous: ['Accélérée', 'Irrégulière'] }, { nom: 'Impulsion', sous: ['Active', 'Passive'] }, { nom: 'Envol', sous: ['Équilibré', 'Déséquil.'] }, { nom: 'Réception', sous: ['Stable', 'Chute'] }] },
    'Saut en hauteur': { criteres: [{ nom: 'Course', sous: ['Courbe', 'Droite'] }, { nom: 'Impulsion', sous: ['Pied ext.', 'Autre'] }, { nom: 'Franchis.', sous: ['Dorsal', 'Autre'] }, { nom: 'Réception', sous: ['Dos', 'Danger'] }] },
    'Course de durée': { criteres: [{ nom: 'Régularité', sous: ['Constante', 'Variable'] }, { nom: 'Allure', sous: ['Adaptée', 'Inadaptée'] }, { nom: 'Posture', sous: ['Correcte', 'Effondrée'] }, { nom: 'Finish', sous: ['Accéléré', 'Ralenti'] }] },
    'Lancer de poids': { criteres: [{ nom: 'Position', sous: ['Dos aire', 'Face'] }, { nom: 'Tenue', sous: ['Au cou', 'Éloigné'] }, { nom: 'Poussée', sous: ['Complète', 'Partielle'] }, { nom: 'Équilibre', sous: ['Stable', 'Chute'] }] },
    'Gymnastique': { criteres: [{ nom: 'Amplitude', sous: ['Suffisante', 'Insuffis.'] }, { nom: 'Tenue', sous: ['Gainé', 'Relâché'] }, { nom: 'Liaisons', sous: ['Fluides', 'Arrêts'] }, { nom: 'Réception', sous: ['Stabilisée', 'Déséquil.'] }] },
    'Tennis de table': { criteres: [{ nom: 'Coup droit', sous: ['Contrôlé', 'Aléatoire'] }, { nom: 'Revers', sous: ['Contrôlé', 'Aléatoire'] }, { nom: 'Service', sous: ['Varié', 'Prévisible'] }, { nom: 'Placement', sous: ['Équilibré', 'Instable'] }] },
    'Badminton': { criteres: [{ nom: 'Dégagé', sous: ['Fond', 'Court'] }, { nom: 'Amorti', sous: ['Près filet', 'Long'] }, { nom: 'Service', sous: ['Réglem.', 'Faute'] }, { nom: 'Replacement', sous: ['Centre', 'Excentré'] }] }
};

const OBJECTIFS_CYCLE = {
    'Handball': ["Évaluer le niveau initial des élèves via un match 4c4 pour identifier les acquis en passe, réception et démarquage.", "Découvrir les règles fondamentales du handball (marcher, reprise de dribble, zone) et manipuler le ballon avec aisance.", "Améliorer la passe à terre: orientation du corps vers la cible, passe tendue à hauteur de poitrine.", "Se démarquer efficacement en créant de l'espace par rapport au défenseur pour recevoir en position favorable.", "Enchaîner réception et passe rapidement sans temps d'arrêt pour maintenir la continuité du jeu collectif.", "Découvrir le tir en appui et améliorer la précision en visant les différentes zones du but.", "Organiser le jeu collectif en largeur et profondeur avec des rôles définis (pivot, ailier, arrière).", "Appliquer les principes d'attaque (écartement, pénétration) en situation de surnombre 4c3.", "Intégrer les acquis techniques et tactiques dans un match 5c5 avec arbitrage par les élèves.", "Évaluer les compétences via la situation de référence en observant efficacité technique et choix tactiques."],
    'Football': ["Évaluer le niveau initial via match 4c4 pour observer conduite de balle, passes et placements.", "Découvrir les règles du football (hors-jeu, fautes, remises) et manipuler le ballon avec différentes surfaces.", "Améliorer la conduite de balle en slalom et le contrôle orienté pour enchaîner vers une passe.", "Travailler la passe courte avec l'intérieur du pied: pied d'appui à côté du ballon, frappe au centre.", "Se démarquer efficacement en effectuant des appels de balle dans le dos du défenseur.", "Découvrir le tir et améliorer la frappe vers le but avec précision.", "Organiser le jeu collectif: circulation de balle, appui-soutien, occupation des couloirs.", "Appliquer le jeu en triangle et les combinaisons simples (une-deux) en situation de match réduit.", "Intégrer les acquis dans un match 6c6 avec respect des règles et des postes.", "Évaluer via la situation de référence en observant efficacité technique, tactique et fair-play."],
    'Basketball': ["Évaluer le niveau initial via un 3c3 pour observer dribble, passe, tir et déplacements.", "Découvrir les règles du basketball (marcher, reprise, fautes) et manipuler le ballon des deux mains.", "Améliorer le dribble de progression main droite puis main gauche face à un défenseur.", "Travailler la passe à terre et la passe à une main vers un partenaire en mouvement.", "Se démarquer avec et sans ballon en utilisant les changements de direction et les feintes.", "Découvrir le tir en course (lay-up) et améliorer la coordination appuis-tir avec la main extérieure.", "Organiser le jeu collectif: espacement entre joueurs, circulation joueurs et ballon.", "Appliquer les principes d'attaque placée et de contre-attaque rapide en situation 4c4.", "Intégrer les acquis dans un match avec arbitrage, rotations et systèmes travaillés.", "Évaluer via la situation de référence en observant efficacité offensive et défensive."],
    'Volleyball': ["Évaluer le niveau initial via échanges 2c2 pour observer manchette, touche haute et service.", "Découvrir les règles du volleyball (3 touches, rotation, fautes) et s'initier à la manchette.", "Améliorer la manchette de réception: se placer sous le ballon, bras tendus, orienter vers le passeur.", "Travailler la touche haute pour une passe précise: mains en coupe au-dessus du front.", "Découvrir le service cuillère et améliorer sa régularité en visant différentes zones.", "Construire une attaque en 3 touches avec rôles définis: réceptionneur, passeur, attaquant.", "Organiser la défense: placement en réception, couverture d'attaque, anticipation.", "Appliquer l'alternance jeu court (amorti) et jeu long (attaque) pour déstabiliser l'adversaire.", "Intégrer les acquis dans un match 4c4 puis 6c6 avec rotation et communication.", "Évaluer via la situation de référence en observant construction du point et communication."],
    'Course de vitesse': ["Évaluer le niveau initial sur 40m chronométré pour identifier les points forts et faibles.", "Découvrir les phases de la course: réaction au signal, mise en action, accélération, maintien.", "Améliorer la réaction au signal et la mise en action explosive sur les 10 premiers mètres.", "Travailler l'accélération progressive en augmentant la fréquence puis l'amplitude des foulées.", "Optimiser la fréquence et l'amplitude des foulées en phase de vitesse maximale.", "Maintenir sa vitesse maximale sans décélération jusqu'à la ligne d'arrivée.", "Améliorer l'alignement segmentaire (tête-tronc-bassin) et le relâchement des épaules.", "Travailler le finish: franchir la ligne sans ralentir, en projetant le buste vers l'avant.", "Intégrer tous les éléments techniques dans des courses chronométrées avec analyse.", "Évaluer la performance finale sur la distance de référence avec mesure du temps."],
    'Saut en longueur': ["Évaluer le niveau initial via 3 sauts libres pour observer course d'élan, impulsion et réception.", "Découvrir les phases du saut: course accélérée, impulsion sur planche, envol, réception.", "Étalonner sa course d'élan en plaçant des marques pour atteindre la planche avec vitesse optimale.", "Améliorer l'impulsion: placement du pied à plat, poussée verticale et horizontale, genou libre haut.", "Travailler la phase d'envol: maintien de l'équilibre, position groupée ou en extension.", "Optimiser la réception: ramener les jambes vers l'avant, bras vers l'avant, tomber en avant.", "Coordonner course-impulsion-envol dans un enchaînement fluide sans perte de vitesse.", "Augmenter progressivement la vitesse de course en conservant la précision sur la planche.", "Réaliser des sauts complets avec mesure des performances et analyse des points à améliorer.", "Évaluer la performance via le concours de 3 essais avec notation technique et mesure."],
    'Saut en hauteur': ["Évaluer le niveau initial via franchissements à hauteur basse pour observer la technique.", "Découvrir les phases: course d'élan courbe, impulsion pied extérieur, franchissement dorsal.", "Travailler la course d'élan courbe: 5-7 foulées en arc de cercle avec accélération progressive.", "Améliorer l'impulsion: pied extérieur actif, bras et genou libre vers le haut, regard vers la barre.", "Découvrir la rotation dorsale (fosbury-flop): basculer les épaules, cambrer le dos.", "Optimiser l'esquive des hanches et des jambes pour franchir la barre sans la toucher.", "Coordonner course courbe-impulsion-rotation dans un enchaînement fluide et rythmé.", "Augmenter progressivement la hauteur en conservant la qualité technique.", "Réaliser des concours avec barres montantes pour développer la gestion du stress.", "Évaluer la performance via le concours à barres montantes avec analyse technique."],
    'Course de durée': ["Évaluer le niveau initial via une course de 6 minutes pour estimer la VMA.", "Découvrir les principes de gestion de l'effort: allure régulière, respiration, hydratation.", "Apprendre à courir à une allure constante en utilisant des repères de temps.", "Travailler la régularité de l'allure: maintenir le même temps de passage sur chaque tour.", "Développer l'endurance en augmentant progressivement la durée de course (8, 10, 12 min).", "Construire un projet de course personnel: définir une allure cible selon ses capacités.", "Optimiser la foulée économique: amplitude modérée, pose du pied sous le centre de gravité.", "Gérer les variations de terrain et de rythme sans perdre sa régularité d'allure.", "Réaliser des courses avec contrat de distance: annoncer et respecter son objectif.", "Évaluer via la course de 12 minutes avec mesure de la distance et analyse de la régularité."],
    'Lancer de poids': ["Évaluer le niveau initial via lancers à bras cassé pour observer coordination et puissance.", "Découvrir la tenue de l'engin au cou et la position de départ dos à l'aire de lancer.", "Travailler le placement initial: poids au cou, coude haut, dos à l'aire, équilibre sur jambe arrière.", "Améliorer la poussée des jambes: transfert du poids du corps de l'arrière vers l'avant.", "Coordonner la rotation du tronc et l'extension du bras lanceur dans un mouvement explosif.", "Travailler le fouetté final du poignet pour optimiser la trajectoire de l'engin.", "Enchaîner translation-rotation-poussée dans un geste fluide et équilibré.", "Respecter l'équilibre final: rester dans le cercle après le lancer, ne pas mordre.", "Réaliser des concours avec 3 essais mesurés et analyse technique de chaque lancer.", "Évaluer la performance via le concours final avec mesure et notation technique."],
    'Gymnastique': ["Évaluer le niveau initial via présentation d'éléments simples (roulade avant, équilibre, saut).", "Découvrir les familles d'éléments: rotations, renversements, sauts, maintiens, souplesses.", "Maîtriser la roulade avant et arrière: départ et arrivée stabilisés, corps groupé.", "Apprendre l'ATR (appui tendu renversé): placement des mains, alignement bras-tronc-jambes.", "Travailler la roue avec amplitude: impulsion jambe, passage par l'ATR, réception pieds décalés.", "Découvrir les éléments de souplesse: pont, souplesse avant, maintiens en équilibre.", "Lier les éléments entre eux: enchaîner 3-4 éléments avec fluidité et sans temps d'arrêt.", "Composer un enchaînement personnel respectant les exigences du niveau.", "Répéter et perfectionner son enchaînement en travaillant amplitude, tenue et liaisons.", "Présenter son enchaînement devant la classe et être évalué selon les critères définis."],
    'Tennis de table': ["Évaluer le niveau initial via échanges libres pour observer coup droit, revers et service.", "Découvrir les règles du tennis de table et la prise de raquette orthodoxe.", "Améliorer le coup droit: placement latéral, rotation du tronc, accompagnement de la balle.", "Travailler le revers: coude près du corps, rotation des épaules, frappe devant soi.", "Découvrir le service réglementaire: balle visible, lancée verticalement, frappée derrière la table.", "Varier les placements pour déplacer l'adversaire: jouer long/court, droite/gauche.", "Découvrir les effets: coupé (balle qui flotte) et lifté (balle qui plonge).", "Construire le point en utilisant des séquences tactiques: service-3ème balle.", "Intégrer les acquis dans des matchs avec comptage des points et application des règles.", "Évaluer via des matchs en simple avec observation technique et tactique."],
    'Badminton': ["Évaluer le niveau initial via échanges libres pour observer frappes et déplacements.", "Découvrir les règles du badminton et la prise universelle de la raquette.", "Améliorer le dégagé (fond de court): frappe haute, bras tendu, accompagnement vers la cible.", "Travailler l'amorti au filet: frappe douce, volant qui tombe près du filet adverse.", "Découvrir le service court et long: trajectoires différentes pour surprendre l'adversaire.", "Varier longueur et direction des frappes pour déplacer l'adversaire et créer des espaces.", "Alterner jeu long (dégagé) et jeu court (amorti) pour déstabiliser l'adversaire.", "Se replacer au centre du terrain après chaque frappe pour couvrir tout l'espace.", "Intégrer les acquis dans des matchs en simple avec application des règles.", "Évaluer via des matchs en observant construction du point et déplacements."]
};

const FALLBACKS = {
    'Handball': { echauf: 'Manipulation balle individuelle (2 min) | Passes en binômes à 6m (3 min) | Jeu des 10 passes 4c2 (3 min)', s1t: 'Conservation et progression collective', s1b: 'Conserver la balle et atteindre la zone de marque', s1o: '4 attaquants vs 2 défenseurs, terrain 20x15m, 4 plots, 1 ballon', s1d: 'Les 4 attaquants conservent le ballon face à 2 défenseurs. 1 point si la balle arrive dans la zone. Rotation toutes les 2 min.', s1c: '1. Regarder avant de passer\n2. Passe à terre tendue\n3. Se démarquer dans l\'espace libre\n4. Appeler la balle bras levé', s1v: 'Simplifier: 4c1, 3 touches obligatoires | Complexifier: 4c3, 2 touches max', s2t: 'Match à thème', s2b: 'Marquer un but en appliquant les techniques travaillées', s2o: '2 équipes de 5 joueurs, terrain 30x20m avec 2 buts', s2d: 'Match avec obligation d\'appliquer l\'objectif. Point bonus (+1) si objectif visible.', s2c: '1. Appliquer l\'objectif travaillé\n2. S\'engager en attaque et défense\n3. Respecter les règles\n4. Communiquer', s2v: 'Simplifier: supériorité numérique | Complexifier: infériorité numérique', cr: '• Orientation du corps vers la cible avant la passe\n• Passe tendue à hauteur de poitrine\n• Déplacement dans l\'espace libre après la passe\n• Réception à deux mains bras tendus', cs: '• 7 passes réussies sur 10 tentatives\n• Atteindre la zone 3 fois sur 5 possessions\n• Temps de possession supérieur à 20 secondes\n• Marquer 2 buts minimum en 5 minutes' },
    'Football': { echauf: 'Conduite slalom (2 min) | Passes intérieur pied 8m (3 min) | Contrôle orienté + passe (3 min)', s1t: 'Conservation et progression', s1b: 'Conserver le ballon et marquer dans le mini-but', s1o: '4c2 sur terrain 25x20m, 2 mini-buts, chasubles, 1 ballon', s1d: 'Les 4 attaquants conservent et progressent vers le but. Rotation après récupération.', s1c: '1. Contrôle orienté vers l\'espace\n2. Passe intérieur du pied\n3. Appel en profondeur\n4. Lever la tête', s1v: 'Simplifier: 4c1 | Complexifier: 4c3, 2 touches', s2t: 'Match à thème', s2b: 'Marquer en utilisant les techniques travaillées', s2o: '2 équipes de 5, terrain 40x25m avec 2 buts', s2d: 'Match avec point bonus si objectif visible.', s2c: '1. Appliquer l\'objectif\n2. Jouer vers l\'avant\n3. Se replacer\n4. Communiquer', s2v: 'Simplifier: joker offensif | Complexifier: 2 touches max', cr: '• Contrôle intérieur pied orienté vers cible\n• Surface de contact au centre du ballon\n• Pied d\'appui à côté du ballon\n• Regard ballon puis cible', cs: '• 8 contrôles réussis sur 10\n• 7 passes arrivées sur 10\n• Conservation 30 secondes minimum\n• 1 but par période de 5 min' },
    'Basketball': { echauf: 'Dribble slalom (2 min) | Passes triangle (3 min) | Lay-up sans opposition (3 min)', s1t: 'Passe et va', s1b: 'Réaliser un passe et va pour marquer', s1o: '3c2 sur demi-terrain avec panier, 1 ballon, chasubles', s1d: 'Les 3 attaquants appliquent le passe et va. Panier = 2 points. Rotation après possession.', s1c: '1. Passer et couper vers le panier\n2. Recevoir en course sans marcher\n3. Finir en lay-up main extérieure\n4. Écarter si défendu', s1v: 'Simplifier: 3c1 | Complexifier: 3c3, écran obligatoire', s2t: 'Match à thème', s2b: 'Marquer en utilisant le passe et va', s2o: '2 équipes de 4, demi-terrain', s2d: 'Match avec bonus pour panier après passe et va.', s2c: '1. Appliquer le passe et va\n2. Espacer le jeu\n3. Défendre son joueur\n4. Communiquer', s2v: 'Simplifier: supériorité | Complexifier: 2 dribbles max', cr: '• Passe tendue hauteur poitrine\n• Coupe directe vers le panier\n• Réception en course regard panier\n• Lay-up appui intérieur main extérieure', cs: '• 6 lay-up réussis sur 10\n• 3 paniers passe et va sur 5\n• 0 marcher sur 10 réceptions\n• Plus de 10 points en 5 min' },
    'Volleyball': { echauf: 'Jonglage manchette (2 min) | Échanges touche haute (3 min) | Service + réception (3 min)', s1t: 'Construction 3 touches', s1b: 'Construire une attaque en 3 touches', s1o: '3c3 terrain réduit 6x9m, filet 2m, 1 ballon', s1d: 'L\'équipe construit en 3 touches. Point bonus si respecté.', s1c: '1. Manchette vers passeur\n2. Touche haute à 1m du filet\n3. Attaque vers sol adverse\n4. Annoncer "j\'ai!"', s1v: 'Simplifier: lancer au lieu de servir | Complexifier: smash obligatoire', s2t: 'Match à thème', s2b: 'Marquer en construisant en 3 touches', s2o: '2 équipes de 4, terrain 7x14m', s2d: 'Match avec bonus point en 3 touches. Rotation toutes les 5 points.', s2c: '1. Construction 3 touches\n2. Communiquer positions\n3. Couvrir attaquant\n4. Rotation', s2v: 'Simplifier: 2 touches autorisées | Complexifier: zone imposée', cr: '• Bras tendus joints pour manchette\n• Mains coupe au-dessus front pour touche\n• Déplacement sous ballon\n• Orientation appuis vers cible', cs: '• 7 manchettes vers passeur sur 10\n• 6 touches exploitables sur 10\n• 3 attaques gagnantes sur 5\n• 4 constructions 3 touches sur 5' }
};

const SCHEMAS = {
    'Handball': { 1: `<svg viewBox="0 0 200 120" style="width:100%;max-width:260px;height:auto;margin:8px auto;display:block;"><rect x="5" y="5" width="190" height="110" fill="#90EE90" stroke="#228B22" stroke-width="2" rx="5"/><rect x="5" y="45" width="25" height="30" fill="none" stroke="#228B22" stroke-width="2"/><rect x="170" y="45" width="25" height="30" fill="none" stroke="#228B22" stroke-width="2"/><circle cx="60" cy="40" r="8" fill="#c1272d"/><text x="60" y="44" text-anchor="middle" fill="white" font-size="10" font-weight="bold">A</text><circle cx="60" cy="80" r="8" fill="#c1272d"/><text x="60" y="84" text-anchor="middle" fill="white" font-size="10" font-weight="bold">A</text><circle cx="100" cy="60" r="8" fill="#c1272d"/><text x="100" y="64" text-anchor="middle" fill="white" font-size="10" font-weight="bold">A</text><circle cx="80" cy="60" r="8" fill="#c1272d"/><text x="80" y="64" text-anchor="middle" fill="white" font-size="10" font-weight="bold">A</text><circle cx="130" cy="50" r="8" fill="#1565c0"/><text x="130" y="54" text-anchor="middle" fill="white" font-size="10" font-weight="bold">D</text><circle cx="130" cy="70" r="8" fill="#1565c0"/><text x="130" y="74" text-anchor="middle" fill="white" font-size="10" font-weight="bold">D</text><path d="M68 40 L92 58" stroke="#333" stroke-width="2" stroke-dasharray="5,3"/><text x="100" y="115" text-anchor="middle" fill="#333" font-size="9" font-weight="bold">4 Att vs 2 Déf</text></svg>`, 2: `<svg viewBox="0 0 200 120" style="width:100%;max-width:260px;height:auto;margin:8px auto;display:block;"><rect x="5" y="5" width="190" height="110" fill="#90EE90" stroke="#228B22" stroke-width="2" rx="5"/><rect x="5" y="45" width="25" height="30" fill="none" stroke="#228B22" stroke-width="2"/><rect x="170" y="45" width="25" height="30" fill="none" stroke="#228B22" stroke-width="2"/><circle cx="50" cy="35" r="7" fill="#c1272d"/><circle cx="50" cy="60" r="7" fill="#c1272d"/><circle cx="50" cy="85" r="7" fill="#c1272d"/><circle cx="80" cy="48" r="7" fill="#c1272d"/><circle cx="80" cy="72" r="7" fill="#c1272d"/><circle cx="120" cy="35" r="7" fill="#1565c0"/><circle cx="120" cy="60" r="7" fill="#1565c0"/><circle cx="120" cy="85" r="7" fill="#1565c0"/><circle cx="150" cy="48" r="7" fill="#1565c0"/><circle cx="150" cy="72" r="7" fill="#1565c0"/><text x="100" y="115" text-anchor="middle" fill="#333" font-size="9" font-weight="bold">Match 5 vs 5</text></svg>` },
    'Football': { 1: `<svg viewBox="0 0 200 120" style="width:100%;max-width:260px;height:auto;margin:8px auto;display:block;"><rect x="5" y="5" width="190" height="110" fill="#90EE90" stroke="#228B22" stroke-width="2" rx="5"/><rect x="5" y="40" width="20" height="40" fill="none" stroke="#228B22" stroke-width="2"/><rect x="175" y="40" width="20" height="40" fill="none" stroke="#228B22" stroke-width="2"/><circle cx="55" cy="40" r="8" fill="#c1272d"/><circle cx="55" cy="80" r="8" fill="#c1272d"/><circle cx="85" cy="50" r="8" fill="#c1272d"/><circle cx="85" cy="70" r="8" fill="#c1272d"/><circle cx="130" cy="55" r="8" fill="#1565c0"/><circle cx="130" cy="75" r="8" fill="#1565c0"/><text x="100" y="115" text-anchor="middle" fill="#333" font-size="9" font-weight="bold">4 vs 2 Progression</text></svg>`, 2: `<svg viewBox="0 0 200 120" style="width:100%;max-width:260px;height:auto;margin:8px auto;display:block;"><rect x="5" y="5" width="190" height="110" fill="#90EE90" stroke="#228B22" stroke-width="2" rx="5"/><rect x="5" y="40" width="20" height="40" fill="none" stroke="#228B22" stroke-width="2"/><rect x="175" y="40" width="20" height="40" fill="none" stroke="#228B22" stroke-width="2"/><circle cx="40" cy="60" r="6" fill="#c1272d"/><circle cx="70" cy="35" r="6" fill="#c1272d"/><circle cx="70" cy="85" r="6" fill="#c1272d"/><circle cx="90" cy="50" r="6" fill="#c1272d"/><circle cx="90" cy="70" r="6" fill="#c1272d"/><circle cx="160" cy="60" r="6" fill="#1565c0"/><circle cx="130" cy="35" r="6" fill="#1565c0"/><circle cx="130" cy="85" r="6" fill="#1565c0"/><circle cx="110" cy="50" r="6" fill="#1565c0"/><circle cx="110" cy="70" r="6" fill="#1565c0"/><text x="100" y="115" text-anchor="middle" fill="#333" font-size="9" font-weight="bold">Match 5 vs 5</text></svg>` },
    'Basketball': { 1: `<svg viewBox="0 0 200 120" style="width:100%;max-width:260px;height:auto;margin:8px auto;display:block;"><rect x="5" y="5" width="190" height="110" fill="#DEB887" stroke="#8B4513" stroke-width="2" rx="5"/><circle cx="175" cy="60" r="20" fill="none" stroke="#8B4513" stroke-width="2"/><circle cx="60" cy="40" r="8" fill="#c1272d"/><circle cx="60" cy="80" r="8" fill="#c1272d"/><circle cx="90" cy="60" r="8" fill="#c1272d"/><circle cx="130" cy="50" r="8" fill="#1565c0"/><circle cx="130" cy="70" r="8" fill="#1565c0"/><text x="95" y="115" text-anchor="middle" fill="#333" font-size="9" font-weight="bold">3 vs 2 Passe et va</text></svg>`, 2: `<svg viewBox="0 0 200 120" style="width:100%;max-width:260px;height:auto;margin:8px auto;display:block;"><rect x="5" y="5" width="190" height="110" fill="#DEB887" stroke="#8B4513" stroke-width="2" rx="5"/><circle cx="175" cy="60" r="20" fill="none" stroke="#8B4513" stroke-width="2"/><circle cx="50" cy="40" r="6" fill="#c1272d"/><circle cx="50" cy="80" r="6" fill="#c1272d"/><circle cx="80" cy="50" r="6" fill="#c1272d"/><circle cx="80" cy="70" r="6" fill="#c1272d"/><circle cx="120" cy="40" r="6" fill="#1565c0"/><circle cx="120" cy="80" r="6" fill="#1565c0"/><circle cx="140" cy="50" r="6" fill="#1565c0"/><circle cx="140" cy="70" r="6" fill="#1565c0"/><text x="95" y="115" text-anchor="middle" fill="#333" font-size="9" font-weight="bold">4 vs 4 Match</text></svg>` },
    'Volleyball': { 1: `<svg viewBox="0 0 200 120" style="width:100%;max-width:260px;height:auto;margin:8px auto;display:block;"><rect x="5" y="5" width="190" height="110" fill="#F0E68C" stroke="#DAA520" stroke-width="2" rx="5"/><line x1="100" y1="5" x2="100" y2="115" stroke="#333" stroke-width="3"/><circle cx="50" cy="40" r="8" fill="#c1272d"/><text x="50" y="44" text-anchor="middle" fill="white" font-size="8" font-weight="bold">R</text><circle cx="50" cy="80" r="8" fill="#c1272d"/><text x="50" y="84" text-anchor="middle" fill="white" font-size="8" font-weight="bold">P</text><circle cx="75" cy="60" r="8" fill="#c1272d"/><text x="75" y="64" text-anchor="middle" fill="white" font-size="8" font-weight="bold">A</text><circle cx="150" cy="40" r="8" fill="#1565c0"/><circle cx="150" cy="80" r="8" fill="#1565c0"/><circle cx="125" cy="60" r="8" fill="#1565c0"/><text x="100" y="115" text-anchor="middle" fill="#333" font-size="9" font-weight="bold">3 vs 3 Construction</text></svg>`, 2: `<svg viewBox="0 0 200 120" style="width:100%;max-width:260px;height:auto;margin:8px auto;display:block;"><rect x="5" y="5" width="190" height="110" fill="#F0E68C" stroke="#DAA520" stroke-width="2" rx="5"/><line x1="100" y1="5" x2="100" y2="115" stroke="#333" stroke-width="3"/><circle cx="35" cy="30" r="6" fill="#c1272d"/><circle cx="65" cy="30" r="6" fill="#c1272d"/><circle cx="35" cy="60" r="6" fill="#c1272d"/><circle cx="65" cy="60" r="6" fill="#c1272d"/><circle cx="135" cy="30" r="6" fill="#1565c0"/><circle cx="165" cy="30" r="6" fill="#1565c0"/><circle cx="135" cy="60" r="6" fill="#1565c0"/><circle cx="165" cy="60" r="6" fill="#1565c0"/><text x="100" y="115" text-anchor="middle" fill="#333" font-size="9" font-weight="bold">4 vs 4 Match</text></svg>` },
    'default': { 1: `<svg viewBox="0 0 200 100" style="width:100%;max-width:260px;height:auto;margin:8px auto;display:block;"><rect x="5" y="5" width="190" height="90" fill="#E8E8E8" stroke="#666" stroke-width="2" rx="8"/><text x="100" y="55" text-anchor="middle" fill="#666" font-size="11">Zone de travail - Situation 1</text></svg>`, 2: `<svg viewBox="0 0 200 100" style="width:100%;max-width:260px;height:auto;margin:8px auto;display:block;"><rect x="5" y="5" width="190" height="90" fill="#E8E8E8" stroke="#666" stroke-width="2" rx="8"/><text x="100" y="55" text-anchor="middle" fill="#666" font-size="11">Zone de travail - Situation 2</text></svg>` }
};

const getSchema = (aps, numSit) => SCHEMAS[aps]?.[numSit] || SCHEMAS['default'][numSit];

module.exports = { OTI, OTC, VOCABULAIRE_APS, getSituationReference, getGroupeAPS, CRITERES_OBS, OBJECTIFS_CYCLE, FALLBACKS, SCHEMAS, getSchema };
